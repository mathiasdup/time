/* ==================== CARTES ====================
   Styles de cartes, arena/fullart/image, main, animations cartes */

        .card {
            width: calc(var(--card-w) * 19 / 24);  /* main = 114×152 */
            height: calc(var(--card-h) * 19 / 24);
            border-radius: 4px;
            position: relative;
            cursor: grab;
            overflow: hidden; 
            transition: transform 0.3s, box-shadow 0.2s; 
            background: linear-gradient(180deg, #2a2a3a 0%, #1a1a25 100%); 
            flex-shrink: 0; 
            border: 2px solid rgba(200,180,140,0.6);
            box-shadow: 0 4px 12px rgba(0,0,0,0.5), 0 2px 4px rgba(0,0,0,0.3);
        }
        .card.dragging { cursor: grabbing; }

        /* === Custom Drag Ghost === */
        .drag-ghost-container {
            contain: layout style;
            will-change: transform;
        }
        .drag-ghost-container.lifting {
            transition: transform 180ms cubic-bezier(0.34, 1.2, 0.64, 1);
        }
        .drag-ghost-container.snapping {
            transition: transform 200ms cubic-bezier(0.2, 0, 0, 1),
                        opacity 150ms ease-out;
        }
        .drag-ghost-container.returning {
            transition: transform 250ms cubic-bezier(0.2, 0, 0, 1),
                        opacity 200ms ease-in;
        }
        .drag-ghost-card,
        .drag-ghost-card.card.arena-style[class*="faction-"] {
            border: 2px solid #252525 !important;
            border-radius: 4px !important;
            overflow: visible !important;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            width: 100% !important;
            height: 100% !important;
            margin: 0 !important;
            cursor: grabbing;
            transform: none !important;
        }
        .card.custom-dragging {
            visibility: hidden;
        }

        /* === Arrow Targeting Mode (sorts/pièges) === */
        #gl-canvas {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 9999;
        }
        .my-hand .card.arrow-dragging,
        .my-hand .card.arena-style.arrow-dragging[class*="faction-"] {
            transform: translateY(-50px) scale(1.2632) !important; /* 19/24 × 24/19 = BASE */
            z-index: 1000 !important;
            border: 2px solid #252525 !important;
            pointer-events: none;
            overflow: visible;
        }

        /* Cartes avec image de fond (nouveau système) */
        /* Template original: 636x934 pixels */
        .card.has-image {
            background-size: cover;
            background-position: center;
            border: none !important;
            overflow: visible;
        }
        .card.has-image .card-art,
        .card.has-image .card-body,
        .card.has-image .card-cost {
            display: none !important;
        }
        /* Coût mana - orbe bleu en haut à gauche (centre orbe ~7% du bord, ~4% du haut) */
        .card.has-image .img-cost {
            position: absolute;
            top: 4%;
            left: 7%;
            font-size: 0.85em;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 4px #000, 0 0 8px #000;
            z-index: 10;
        }
        .card.has-image .img-cost.discounted {
            color: #4caf50;
            text-shadow: 0 0 4px #000, 0 0 8px #1b5e20, 0 0 12px rgba(76, 175, 80, 0.8);
        }
        /* Sous-type - caché car pas de zone sur le template */
        .card.has-image .img-subtype {
            display: none;
        }
        /* Nom de la carte - bannière rouge (centre bannière ~50% du haut) */
        .card.has-image .img-name {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.48em;
            font-weight: bold;
            color: #fff;
            text-shadow: 1px 1px 2px #000, 0 0 4px #000;
            white-space: nowrap;
            text-transform: uppercase;
            letter-spacing: 1px;
            z-index: 10;
        }
        /* Type de créature - zone texte haut (~72% du haut) */
        .card.has-image .img-type-line {
            position: absolute;
            top: 72%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.28em;
            color: #bbb;
            text-shadow: 1px 1px 2px #000;
            white-space: nowrap;
            z-index: 10;
        }
        /* Capacités - zone texte milieu (~78% du haut) */
        .card.has-image .img-abilities {
            position: absolute;
            top: 78%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.32em;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 1px 1px 2px #000, 0 0 4px #000;
            white-space: nowrap;
            z-index: 10;
        }
        /* ATK - gemme verte bas gauche (~93% du haut, ~15% du bord) */
        .card.has-image .img-atk {
            position: absolute;
            bottom: 4.5%;
            left: 15%;
            font-size: 0.75em;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 4px #000, 0 0 8px #000;
            z-index: 10;
        }
        /* HP - gemme rouge bas droite (~93% du haut, ~85% du bord gauche) */
        .card.has-image .img-hp {
            position: absolute;
            bottom: 4.5%;
            right: 15%;
            font-size: 0.75em;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 4px #000, 0 0 8px #000;
            z-index: 10;
        }
        .card.has-image .img-hp.reduced,
        .card.has-image .img-atk.reduced {
            color: #ff6b6b;
        }
        .card.has-image .img-atk.boosted,
        .card.has-image .img-hp.boosted {
            color: #2ecc71;
            font-weight: 900;
            text-shadow: 0 0 6px rgba(46, 204, 113, 0.8);
        }
        .card.has-image.just-played { border: 2px solid rgba(255,255,255,0.6) !important; }
        .card.has-image.can-attack { border: 2px solid #252525 !important; }


        /* ========== STYLE ARENA (Magic Arena) ========== */
        .card.arena-style {
            background-size: cover;
            background-position: center;
            border-radius: 10px;
            border: 2px solid #333;
            position: relative;
            overflow: visible;
            will-change: transform;
            transform: translateZ(0);
        }

        /* Titre en haut - fond vert par défaut */
        .card.arena-style .arena-title {
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            text-align: center;
        }
        .card.arena-style .arena-name {
            font-family: 'Bree Serif', serif;
            font-size: 0.6em;
            color: #e5e5e5;
            -webkit-text-stroke: 2px #353535;
            paint-order: stroke fill;
            letter-spacing: 0.2px;
            line-height: 10px;
            white-space: nowrap;
            overflow: hidden;
        }

        /* Zone de texte au milieu */
        .card.arena-style .arena-text-zone {
            padding-left: 3px;
            padding-right: 3px;
            position: absolute;
            bottom: 24px;
            left: 2px;
            right: 2px;
            height: 60px;
            border-radius: 4px;
            text-align: left;
            overflow: visible;
        }
        .card.arena-style.card-spell .arena-text-zone {
            bottom: 14px;
        }
        .card.arena-style .arena-type {
            margin-top: 3px;
            font-family: 'Quicksand', sans-serif;
            font-size: 4px;
            font-weight: 500;
            color: #ffd700;
            text-align: center;
        }
        .card.arena-style .arena-abilities {
            font-family: 'Quicksand', sans-serif;
            font-size: 6px;
            font-weight: 600;
            color: #e5e5e5;
            margin-top: 1px;
            text-align: left;
        }
        .card.arena-style .arena-special {
            font-family: 'Quicksand', sans-serif;
            font-size: 6px;
            font-weight: 500;
            color: #d0d0d0;
            margin-top: 2px;
            line-height: 1.2;
            text-align: left;
        }

        /* Icône type de créature - en haut à droite sous le titre */
        .card.arena-style .arena-creature-type {
            position: absolute;
            top: 14%;
            right: 2px;
            z-index: 10;
            background: #e7d13cd6;
            border-radius: 50%;
            padding: 0.5px;
            line-height: 0;
        }
        .card.arena-style .arena-creature-type img {
            width: 10px;
            height: 10px;
            object-fit: contain;
            display: block;
        }

        /* ========== ICÔNE DE RARETÉ - DIAMANT STYLE MTG ========== */
        .card.arena-style .arena-edition {
            position: absolute;
            bottom: 2px;
            left: 0;
            right: 0;
            margin: 0 auto;
            z-index: 10;
            width: 10px;
            height: 10px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card.arena-style .rarity-icon {
            width: 6px;
            height: 6px;
            position: relative;
            transform: rotate(45deg);
            border-radius: 1px;
        }

        .card.arena-style .rarity-icon .inner-shape {
            position: absolute;
            inset: 2px;
            border-radius: 0.5px;
        }

        /* COMMON - Noir */
        .card.arena-style .rarity-icon.common {
            background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
        }
        .card.arena-style .rarity-icon.common .inner-shape {
            background: #444;
        }

        /* UNCOMMON - Argenté */
        .card.arena-style .rarity-icon.uncommon {
            background: linear-gradient(135deg, #9a9a9a 0%, #6e6e6e 50%, #858585 100%);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3),
                        inset 0 1px 4px rgba(200, 200, 200, 0.5),
                        inset 0 -1px 4px rgba(0, 0, 0, 0.3);
            animation: silverShimmer 3s ease-in-out infinite;
        }
        .card.arena-style .rarity-icon.uncommon .inner-shape {
            background: linear-gradient(135deg, #c0c0c0 0%, #888 100%);
        }

        /* RARE - Or */
        .card.arena-style .rarity-icon.rare {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 25%, #ffa500 50%, #ff8c00 75%, #ffd700 100%);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2),
                        0 0 8px rgba(255, 215, 0, 0.6),
                        inset 0 1px 4px rgba(255, 255, 200, 0.8),
                        inset 0 -1px 4px rgba(204, 153, 0, 0.4);
            animation: rarityGoldPulse 2.5s ease-in-out infinite;
        }
        .card.arena-style .rarity-icon.rare .inner-shape {
            background: linear-gradient(135deg, #fffacd 0%, #ffb700 100%);
        }

        /* MYTHIC - Orange/Rouge flamboyant */
        .card.arena-style .rarity-icon.mythic {
            background: linear-gradient(135deg, #ff4500 0%, #ff6347 25%, #ff8c00 50%, #ffa500 75%, #ff4500 100%);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3),
                        0 0 10px rgba(255, 100, 50, 0.7),
                        inset 0 1px 5px rgba(255, 200, 100, 0.8),
                        inset 0 -1px 5px rgba(180, 30, 0, 0.5);
            animation: rarityMythicFlame 2s ease-in-out infinite;
        }
        .card.arena-style .rarity-icon.mythic .inner-shape {
            background: linear-gradient(135deg, #ffeb3b 0%, #ff5722 100%);
        }

        /* PLATINUM - Blanc brillant */
        .card.arena-style .rarity-icon.platinum {
            background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 25%, #e8e8e8 50%, #f5f5f5 75%, #ffffff 100%);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15),
                        0 0 12px rgba(255, 255, 255, 0.8),
                        inset 0 1px 5px rgba(255, 255, 255, 1),
                        inset 0 -1px 4px rgba(200, 200, 200, 0.3);
            animation: rarityPlatinumShine 3s ease-in-out infinite;
        }
        .card.arena-style .rarity-icon.platinum .inner-shape {
            background: linear-gradient(135deg, #fff 0%, #ddd 100%);
        }

        @keyframes silverShimmer {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.25); }
        }
        @keyframes rarityGoldPulse {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.25); }
        }
        @keyframes rarityMythicFlame {
            0%, 100% { filter: brightness(1) saturate(1.2); }
            50% { filter: brightness(1.3) saturate(1.5); }
        }
        @keyframes rarityPlatinumShine {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.15); }
        }

        /* Mana - Cercle métallique bleu style héros mana pool */
        .card.arena-style .arena-mana {
            position: absolute;
            top: 21px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: rgba(50, 90, 160, 0.75);
            border: 1px solid #6baef0;
            border-radius: 2px 10px 2px 10px;
            display: flex;
            align-items: normal;
            justify-content: center;
            font-family: 'Cinzel', serif;
            font-size: 15px;
            font-weight: 900;
            color: #ffffff;
            text-shadow: 0 0 15px rgba(123, 184, 232, 0.4), 0 2px 4px rgba(0, 0, 0, 0.8);
            z-index: 10;
            pointer-events: none;
        }
        /* Mana réduit par Hyrule - chiffre vert */
        .card.arena-style .arena-mana.discounted {
            color: #4caf50;
            text-shadow: 0 0 6px #1b5e20, 0 0 10px rgba(76, 175, 80, 0.8);
        }

        /* Stats - Pilule style Magic Arena */
        .card.arena-style .arena-stats {
            position: absolute;
            bottom: 2px;
            height: 12%;
            right: -6px;
            border-radius: 12px;
            padding: 0px 6px 0px 6px;
            font-family: 'Cinzel', serif;
            font-size: 0.8em;
            font-weight: 900;
            color: #e5e5e5;
            z-index: 10;
            text-shadow: 0 0 15px rgba(123, 184, 232, 0.4), 0 2px 4px rgba(0, 0, 0, 0.8);
            text-align: center;
        }
        /* Stats individuelles colorées */
        .card.arena-style .arena-atk.boosted,
        .card.arena-style .arena-hp.boosted,
        .card.arena-style .arena-special .boosted,
        .card.arena-style .arena-abilities .boosted {
            color: #7fff7f;
            font-weight: 900;
        }
        .card.arena-style .arena-atk.reduced,
        .card.arena-style .arena-hp.reduced {
            color: #ff6b6b;
        }

        /* Version terrain : pas de mana affiché */
        .card.arena-style.on-field:not(.in-graveyard) .arena-title {
            display: none;
        }
        .card.arena-style.on-field .arena-mana {
            display: none;
        }
        .card.arena-style.on-field .arena-stats {
            min-width: 40px;
            height: 22px;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
        }
        /* Bâtiments : repositionner le conteneur stats */
        .card.arena-style.card-building .arena-stats {
            top: 20px;
        }
        .card-slot .card.arena-style.on-field.card-building .arena-stats,
        .drag-ghost-card.arena-style.card-building .arena-stats {
            top: 2px;
        }
        /* Style de l'armor (HP bâtiment) */
        .card.arena-style .arena-stats .arena-armor {
            background: #8c8888e3;
            border: 1px solid #beb4b4bd;
            border-radius: 10px 2px 10px 2px;
            color: #fff;
            width: 20px;
            height: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .card-slot .card.arena-style.on-field .arena-stats .arena-armor,
        .drag-ghost-card.arena-style .arena-stats .arena-armor {
            width: 30px;
            height: 30px;
            font-size: 20px;
            border-width: 2px;
        }

        /* États arena-style — bordures et glow gérés plus bas avec spécificité élevée */

        /* ========== STYLES PAR FACTION - Bordures mono-couleur ========== */
        .card.arena-style.faction-green { --faction-border: #4a7a5a; }
        .card.arena-style.faction-red { --faction-border: #a04048; }
        .card.arena-style.faction-black { --faction-border: #5a5a5a; }
        .card.arena-style.faction-blue { --faction-border: #6a93d9; }
        .card.arena-style.faction-white { --faction-border: #d5d0c5; }
        .card.arena-style.faction-neutral { --faction-border: #6b5535; }

        /* Bordure de carte - noir sombre 2px */
        .card.arena-style[class*="faction-"] {
            position: relative;
            border: 2px solid #353535 !important;
            border-radius: 4px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        /* Titre - bordure mono-couleur */
        .card.arena-style[class*="faction-"] .arena-title {
            background: #323e82c4;
            border: 2px solid var(--faction-border);
            border-radius: 4px;
        }
        .card.arena-style[class*="faction-"] .arena-name {
            padding: 1px 6px 2px 6px;
        }
        .card.arena-style.faction-red .arena-title { background: rgb(189 66 66 / 50%); }
        .card.arena-style.faction-blue .arena-title { background: #323e828a; }
        .card.arena-style.faction-white .arena-title { background: #ffffff91; }
        .card.arena-style.faction-green .arena-title { background: #29573c94; }
        .card.arena-style.faction-black .arena-title { background: #2a2a2acc; }
        .card.arena-style.faction-neutral .arena-title { background: #573a29b5; }

        /* Zone de texte - bordure mono-couleur */
        .card.arena-style[class*="faction-"] .arena-text-zone {
            background: rgba(0, 0, 0, 0.72);
            border: 2px solid var(--faction-border);
        }
        .card.arena-style.faction-black .arena-text-zone { background: rgba(20, 20, 20, 0.8); }

        /* Stats - bordure mono-couleur */
        .card.arena-style[class*="faction-"] .arena-stats {
            background: rgba(0, 0, 0, 0.5) !important;
            border: 2px solid var(--faction-border);
        }
        /* Ronds séparés ATK / HP — toutes factions */
        .card.arena-style[class*="faction-"] .arena-stats {
            left: 2px;
            right: 2px;
            background: none !important;
            border: none !important;
            border-radius: 0 !important;
            padding: 0;
            display: flex;
            justify-content: space-between;
            font-size: 0;
            height: auto;
            min-width: auto;
        }
        .card.arena-style[class*="faction-"] .arena-stats .arena-atk,
        .card.arena-style[class*="faction-"] .arena-stats .arena-hp {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 15px;
            font-weight: 900;
            color: #e5e5e5;
        }
        .card.arena-style[class*="faction-"] .arena-stats .arena-atk {
            background: #f96916c2;
            border: 1px solid #f06717;
            border-radius: 10px 2px 10px 2px;
        }
        .card.arena-style[class*="faction-"] .arena-stats .arena-hp {
            background: #9a1b1bd6;
            border: 1px solid #dc4d4dbd;
            border-radius: 2px 10px 2px 10px;
        }
        /* Bâtiments — stats uniquement à droite (pas de left) */
        .card.arena-style.card-building[class*="faction-"] .arena-stats {
            left: auto;
        }
        /* Board — ronds plus grands */
        .card-slot .card.arena-style.on-field[class*="faction-"] .arena-stats .arena-atk,
        .card-slot .card.arena-style.on-field[class*="faction-"] .arena-stats .arena-hp {
            width: 30px;
            height: 30px;
            font-size: 20px;
        }
        .card-slot .card.arena-style.on-field[class*="faction-"] .arena-stats .arena-atk {
            border: 2px solid #f06717;
        }
        .card-slot .card.arena-style.on-field[class*="faction-"] .arena-stats .arena-hp {
            border: 2px solid #dc4d4dbd;
        }
        /* Boosted/reduced — spécificité suffisante pour écraser la couleur par défaut */
        .card.arena-style[class*="faction-"] .arena-stats .arena-atk.boosted,
        .card.arena-style[class*="faction-"] .arena-stats .arena-hp.boosted {
            color: #7fff7f;
        }
        .card.arena-style[class*="faction-"] .arena-stats .arena-atk.reduced,
        .card.arena-style[class*="faction-"] .arena-stats .arena-hp.reduced {
            color: #ff6b6b;
        }

        /* Faction white - texte clair */
        .card.arena-style.faction-white .arena-name { color: #e5e5e5; }

        /* Cartes créatures sur le board — nom plus grand */
        .card-slot .card.arena-style .arena-name {
            font-size: 0.8em;
        }
        .card-slot .card.arena-style[class*="faction-"] .arena-name {
            padding: 4px 6px 5px 6px;
        }
        .card-slot .card.arena-style.on-field .arena-stats {
        }

        /* Code couleur des bordures — double classe pour écraser faction */
        .card.card.just-played, .card.arena-style.just-played[class*="faction-"] {
            border: 2px solid rgba(255,255,255,0.4) !important;
        }
        .card.card.can-attack, .card.arena-style.can-attack[class*="faction-"] {
            overflow: visible;
            border: 2px solid rgba(255, 255, 255, 0.4) !important;
        }
        .card.card.field-selected, .card.arena-style.field-selected[class*="faction-"] {
            border-color: #3498db !important;
        }

        /* Cartes jouables en main — bordure normale, le glow Canvas est derrière */
        .card.card.playable, .card.arena-style.playable[class*="faction-"] {
            border-color: #353535 !important;
            overflow: visible;
        }

        /* Surbrillance orange quand un sort/piège cible une créature */
        .card.card.spell-hover-target, .card.arena-style.spell-hover-target[class*="faction-"] {
            border: 2px solid transparent !important;
            overflow: visible;
        }


        /* === Animated gradient borders (conic-gradient rotatif dans un ::after masqué) === */
        @property --border-angle {
            syntax: '<angle>';
            initial-value: 0deg;
            inherits: false;
        }
        @keyframes rotateBorder {
            to { --border-angle: 360deg; }
        }

        /* Slots — bordures mono-couleur (comme les trap-slots) */
        .card-slot.valid-target {
            border-color: #62d7ff !important;
            background: rgba(98,215,255,0.15) !important;
        }
        .card-slot.cross-target,
        .card-slot.drag-over {
            border-color: #f1c40f !important;
            background: rgba(241,196,15,0.2) !important;
        }

        /* Héros — bordures mono-couleur */
        .hero-card.hero-targetable {
            border-color: #62d7ff !important;
            background: rgba(98,215,255,0.15) !important;
        }
        .hero-card.hero-drag-over {
            border-color: #f1c40f !important;
            background: rgba(241,196,15,0.2) !important;
        }

        /* Bleu = créature ciblable par un sort (avant hover) */
        .card.card.spell-targetable, .card.arena-style.spell-targetable[class*="faction-"] {
            border-color: #62d7ff !important;
        }
        /* Orange mono-couleur = spell hover sur créature */
        .card.card.spell-hover-target, .card.arena-style.spell-hover-target[class*="faction-"] {
            border-color: #f39c12 !important;
            box-shadow: 0 0 8px rgba(243, 156, 18, 0.5);
        }
        /* Ghost card : pas de ::after gradient, le glow orange remplace */

        /* ANIMATIONS */
        .card.attacking { animation: attackAnim 0.4s ease-out; }
        @keyframes attackAnim { 0% { transform: translateX(0); } 50% { transform: translateX(30px) scale(1.1); } 100% { transform: translateX(0); } }

        /* Animation de recul pour tireurs */
        .card.shooting { animation: shootRecoil 0.3s ease-out; }
        @keyframes shootRecoil { 0% { transform: translateX(0); } 30% { transform: translateX(-8px) scale(0.95); } 100% { transform: translateX(0); } }
        
        
        .card.dying { animation: deathAnim 0.6s ease-out forwards; }
        @keyframes deathAnim { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0) rotate(180deg); opacity: 0; } }
        
        /* Animation de pop pour invocation (overlay fixe) */
        .card.summon-overlay { 
            animation: summonPop 0.5s ease-out forwards; 
        }
        @keyframes summonPop { 
            0% { transform: scale(0); opacity: 0; } 
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; } 
        }
        
        /* Fondu de sortie pour l'overlay */
        .card.summon-overlay.fade-out {
            animation: none;
            opacity: 0;
            transition: opacity 0.15s ease-out;
        }
        
        
        /* Carte fantôme pour animation de déplacement */
        .card-moving {
            position: fixed;
            z-index: 3000;
            pointer-events: none;
            transition: left 0.5s ease-in-out, top 0.5s ease-in-out;
        }
        
        /* Carte affichée lors des sorts/pièges */
        .card-showcase { 
            position: fixed; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%) scale(2); 
            z-index: 2000; 
            animation: showcaseAnim 1.5s ease-out forwards;
            pointer-events: none;
        }
        @keyframes showcaseAnim { 
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 
            20% { opacity: 1; transform: translate(-50%, -50%) scale(2.2); }
            70% { opacity: 1; transform: translate(-50%, -50%) scale(2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); } 
        }
        
        /* Vibration pour carte non jouable */
        .card.shake { animation: shakeAnim 0.4s ease-out; }
        @keyframes shakeAnim {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
        }
        
        /* Retour smooth dans la main */
        .card.returning { 
            transition: transform 0.3s ease-out, left 0.3s ease-out, top 0.3s ease-out;
        }
        
        .attack-projectile { position: fixed; z-index: 1000; font-size: 2em; pointer-events: none; transition: all 0.3s ease-out; }
        
        
        /* Les animations de dégâts sont maintenant gérées par PixiJS */
        /* Voir combat-animations.js pour les griffures et effets visuels */


        /* Animation de lévitation pour les créatures volantes */
        .card.flying-creature {
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.6), 0 0 20px rgba(135, 206, 250, 0.4);
            /* Décalage vers le haut pour montrer l'emplacement en dessous */
            position: relative;
            z-index: 10;
            /* GPU compositing : la carte + stats bougent comme une seule texture, élimine le tremblement */
            will-change: transform;
            backface-visibility: hidden;
        }

        /* Death Transform: Petit Os -> Pile d'Os (tout en rAF, pas de keyframes) */


        /* Le slot avec un volant - pas de couleur spéciale */
        
        /* MAIN DU JOUEUR - 30% cachée (partie inférieure hors écran) */
        .my-hand {
            position: absolute;
            bottom: -30px; /* Cache ~20% de la carte */
            left: 185px;
            display: flex; 
            padding: 10px 15px 0 15px;
            background: transparent; 
            max-width: calc(50% - 150px); 
            z-index: 20;
        }
        .my-hand .card {
            margin-left: -44px;
            transition: transform 0.2s ease-out, z-index 0s;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
            transform-origin: bottom center;
        }
        .my-hand .card:first-child { margin-left: 0; }
        .my-hand .card:hover:not(.dragging), .my-hand .card.dragging {
            transform: translateY(-50px) scale(1.2632); /* 19/24 × 24/19 = BASE */
            z-index: 100 !important;
            animation: none !important;
        }
        .my-hand .card.playable:hover:not(.dragging) {
            border-color: #353535 !important;
        }
        .my-hand .card.selected {
            transform: translateY(-55px) scale(1.4737); /* → 168×224 (sélectionnée) */
            z-index: 101 !important;
        }
        
        /* MAIN ADVERSE - 30% cachée */
        .opp-hand {
            position: absolute;
            bottom: -60px; /* 50% cachée */
            right: 185px;
            display: flex; 
            padding: 10px 15px 0 15px;
            background: transparent;
            z-index: 20;
        }
        .opp-card-back {
            width: calc(var(--card-w) * 19 / 24);
            height: calc(var(--card-h) * 19 / 24);
            margin-left: -60px;
            border-radius: 4px;
            background: url('../cardback/back_1.png') center/cover no-repeat;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            flex-shrink: 0;
            position: relative;
            z-index: 1;
            transition: transform 0.2s ease-out, z-index 0s;
        }
        .opp-card-back:first-child { margin-left: 0; }
        .opp-card-back:hover {
            transform: translateY(-50px);
        }
        .opp-card-back.opp-revealed {
            background-image: none;
            background-size: cover;
            background-position: center;
            width: calc(var(--card-w) * 19 / 24);
            height: calc(var(--card-h) * 19 / 24);
            cursor: pointer;
        }
        .opp-card-back.opp-revealed .arena-stats {
            font-size: 0.7em;
            bottom: -6px;
            right: -4px;
        }
        .opp-card-back.opp-revealed .arena-mana {
            font-size: 0.55em;
            width: 15px;
            height: 15px;
            line-height: 15px;
        }
        .opp-card-back.opp-revealed .arena-text-zone {
            bottom: 10px;
            font-size: 0.7em;
        }

        /* ========== MELODY LOCK & PETRIFICATION ========== */

        /* Créature bloquée par Mélodie — terni par-dessus tout sauf stats */
        .card.melody-locked {
            position: relative;
            isolation: isolate;
        }
        .card.melody-locked::before {
            content: '';
            position: absolute;
            inset: -4px;
            background: #909090;
            mix-blend-mode: saturation;
            opacity: 0.6;
            z-index: 14;
            border-radius: 8px;
            pointer-events: none;
        }
        .card.melody-locked .arena-stats {
            z-index: 15 !important;
        }

        /* Créature pétrifiée — N&B complet sauf stats */
        .card.petrified {
            position: relative;
            isolation: isolate;
        }
        /* Couche de désaturation via mix-blend-mode */
        .card.petrified::before {
            content: '';
            position: absolute;
            inset: -4px;
            background: #707070;
            mix-blend-mode: saturation;
            opacity: 1;
            z-index: 14;
            border-radius: 8px;
            pointer-events: none;
        }
        /* Stats restent colorées au-dessus du N&B */
        .card.petrified .arena-stats {
            z-index: 15 !important;
        }

        /* Jeton compteur de gaze (Medusa) — bordure gradient violet rotatif */
        .gaze-marker {
            position: absolute;
            top: 2px;
            right: 6px;
            width: 24px;
            height: 24px;
            background: #6b21a8;
            border: 2px solid #D0BBA0;
            border-radius: 50%;
            color: #e5e5e5;
            font-size: 1em;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20;
        }

        .poison-marker {
            position: absolute;
            top: 2px;
            right: 6px;
            width: 24px;
            height: 24px;
            background: #479805;
            border: 2px solid #D0BBA0;
            border-radius: 50%;
            color: #e5e5e5;
            font-size: 1em;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20;
        }

        .entrave-marker {
            position: absolute;
            top: 2px;
            right: 6px;
            width: 24px;
            height: 24px;
            background: #1a1a1a;
            border: 2px solid #D0BBA0;
            border-radius: 50%;
            color: #e5e5e5;
            font-size: 1em;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20;
        }

        .buff-marker {
            position: absolute;
            top: 2px;
            right: 6px;
            width: 24px;
            height: 24px;
            background: #0e4d82;
            border: 2px solid #D0BBA0;
            border-radius: 50%;
            color: #e5e5e5;
            font-size: 1em;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20;
        }

        /* Cacher titre, stats et markers sur les cartes au cimetière (pile uniquement, pas la popup) */
        .grave-card-layer .card.in-graveyard .arena-title,
        .grave-card-layer .card.in-graveyard .arena-stats,
        .grave-card-layer .card.in-graveyard .arena-mana,
        .grave-top-card .card.in-graveyard .arena-title,
        .grave-top-card .card.in-graveyard .arena-stats,
        .grave-top-card .card.in-graveyard .arena-mana {
            display: none !important;
        }
        .card.in-graveyard .gaze-marker,
        .card.in-graveyard .poison-marker,
        .card.in-graveyard .entrave-marker,
        .card.in-graveyard .buff-marker {
            display: none;
        }

        /* Animation pop d'apparition des marqueurs */
        @keyframes markerPop {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.35); opacity: 1; }
            70% { transform: scale(0.9); }
            85% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        .marker-pop {
            animation: markerPop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        /* Flash du compteur quand il s'incrémente */
        @keyframes markerCountBump {
            0% { transform: scale(1); }
            30% { transform: scale(1.4); color: #fff; }
            100% { transform: scale(1); }
        }
        .marker-bump {
            animation: markerCountBump 0.3s ease-out;
        }


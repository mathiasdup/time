<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öîÔ∏è Bataille des H√©ros</title>
    <script src="/socket.io/socket.io.js"></script>
    <!-- PixiJS pour les animations de combat -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/8.2.6/pixi.min.js"></script>
    <!-- Polices pour les cartes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bree+Serif&family=IM+Fell+English+SC&family=Merriweather+Sans:wght@400;700;800&family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/glacial-indifference" rel="stylesheet">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/cards.css">
    <link rel="stylesheet" href="/css/ui.css">
</head>
<body>
    <!-- Curseur fantasy custom -->
    <div class="cursor-fantasy" id="cursor-fantasy">
        <div class="cursor-fantasy-main">
            <svg viewBox="-6 -6 38 38" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="orangeFill" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#ffab40"/>
                        <stop offset="15%" stop-color="#ff9100"/>
                        <stop offset="30%" stop-color="#ff6d00"/>
                        <stop offset="50%" stop-color="#e65100"/>
                        <stop offset="70%" stop-color="#ff6d00"/>
                        <stop offset="85%" stop-color="#bf360c"/>
                        <stop offset="100%" stop-color="#e65100"/>
                    </linearGradient>
                    <linearGradient id="silverStroke" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#6a6a6a"/>
                        <stop offset="15%" stop-color="#9a9a9a"/>
                        <stop offset="30%" stop-color="#808080"/>
                        <stop offset="50%" stop-color="#5a5a5a"/>
                        <stop offset="70%" stop-color="#808080"/>
                        <stop offset="85%" stop-color="#a0a0a0"/>
                        <stop offset="100%" stop-color="#6a6a6a"/>
                    </linearGradient>
                    <linearGradient id="cursorShine" x1="0%" y1="0%" x2="60%" y2="60%">
                        <stop offset="0%" stop-color="#ffcc80" stop-opacity="0.4"/>
                        <stop offset="50%" stop-color="#ffab40" stop-opacity="0.2"/>
                        <stop offset="100%" stop-color="#ff9100" stop-opacity="0"/>
                    </linearGradient>
                </defs>
                <path d="M -2,-2 L 10,26 L 14,14 L 26,10 Z" fill="rgba(0,0,0,0.4)" transform="translate(2, 2)"/>
                <path d="M -2,-2 L 10,26 L 14,14 L 26,10 Z" fill="url(#orangeFill)" stroke="url(#silverStroke)" stroke-width="2" stroke-linejoin="round" stroke-linecap="round"/>
                <path d="M -1,-1 L 5,14 L 8,8 L 14,5 Z" fill="url(#cursorShine)"/>
            </svg>
        </div>
    </div>

    <div id="game-scaler">

    <div class="lobby" id="lobby">
        <h1 class="lobby-title">‚öîÔ∏è Bataille des H√©ros</h1>
        <div class="lobby-box" id="lobby-menu">
            <h2 style="margin-bottom:25px;color:#ffd700;">Multijoueur</h2>
            <button class="lobby-btn btn-create" onclick="createRoom()">üéÆ Cr√©er une partie</button>
            <div style="margin:18px 0;color:#666;">‚Äî ou ‚Äî</div>
            <input type="text" class="room-code-input" id="room-code-input" placeholder="CODE" maxlength="6">
            <button class="lobby-btn btn-join" onclick="joinRoom()">üö™ Rejoindre</button>
        </div>
        <div class="lobby-box hidden" id="lobby-waiting">
            <h2 style="color:#ffd700;margin-bottom:15px;">Partie cr√©√©e !</h2>
            <p style="color:#aaa;margin-bottom:8px;">Partagez ce code :</p>
            <div class="room-code-display" id="room-code-display">------</div>
            <p class="waiting-text">‚è≥ En attente d'un adversaire...</p>
        </div>
    </div>
    
    <!-- Card Zoom Overlay -->
    <div class="card-zoom-overlay hidden" id="card-zoom-overlay">
        <div class="card-zoom-container" id="card-zoom-container"></div>
    </div>

    <!-- Mulligan Overlay -->
    <div class="mulligan-overlay hidden" id="mulligan-overlay">
        <div class="mulligan-timer" id="mulligan-timer">15</div>
        <div class="mulligan-title">üé¥ Votre Main de D√©part</div>
        <div class="mulligan-subtitle">Gardez cette main ou piochez 7 nouvelles cartes</div>
        <div class="mulligan-hand" id="mulligan-hand"></div>
        <div class="mulligan-buttons" id="mulligan-buttons">
            <button class="mulligan-btn keep" onclick="keepHand()">‚úÖ Garder</button>
            <button class="mulligan-btn reroll" onclick="doMulligan()">üîÑ Mulligan</button>
        </div>
        <div class="mulligan-waiting hidden" id="mulligan-waiting">‚è≥ En attente de l'adversaire...</div>
    </div>

    <!-- Mode Selector Overlay -->
    <div class="mode-selector-overlay hidden" id="mode-selector-overlay">
        <div class="mode-selector-title">Mode de jeu</div>
        <div class="mode-selector-subtitle">Choisissez comment commencer cette partie</div>
        <div class="mode-selector-buttons">
            <button class="mode-btn mode-normal" onclick="selectMode('normal')">
                <div class="mode-btn-icon">&#9876;</div>
                <div class="mode-btn-label">Partie normale</div>
                <div class="mode-btn-desc">Main al√©atoire classique</div>
            </button>
            <button class="mode-btn mode-test" onclick="selectMode('test')">
                <div class="mode-btn-icon">&#9881;</div>
                <div class="mode-btn-label">Mode test</div>
                <div class="mode-btn-desc">Choisissez vos cartes</div>
            </button>
            <button class="mode-btn mode-complete" onclick="selectMode('complete')">
                <div class="mode-btn-icon">&#9760;</div>
                <div class="mode-btn-label">Mode complet</div>
                <div class="mode-btn-desc">Construisez votre deck noir</div>
            </button>
        </div>
    </div>

    <!-- Card Picker Overlay (Test Mode / Complete Mode) -->
    <div class="card-picker-overlay hidden" id="card-picker-overlay">
        <div class="card-picker-header">
            <div class="card-picker-title" id="card-picker-title">Choisissez vos cartes</div>
            <div class="card-picker-counter" id="card-picker-counter">0 / 7 cartes</div>
        </div>
        <div class="card-picker-tabs">
            <button class="picker-tab active" data-tab="creatures" onclick="switchPickerTab('creatures')">Cr√©atures</button>
            <button class="picker-tab" data-tab="spells" onclick="switchPickerTab('spells')">Sorts</button>
            <button class="picker-tab" data-tab="traps" onclick="switchPickerTab('traps')">Pi√®ges</button>
        </div>
        <div class="card-picker-grid" id="card-picker-grid"></div>
        <div class="card-picker-selection" id="card-picker-selection">
            <div class="card-picker-selection-label" id="card-picker-selection-label">Votre main :</div>
            <div class="card-picker-selection-row" id="card-picker-selection-row"></div>
        </div>
        <div class="deck-list-section hidden" id="deck-list-section">
            <div class="deck-list-header">
                <span class="deck-list-title">Votre deck :</span>
                <span class="deck-list-count" id="deck-list-count">0 / 40</span>
            </div>
            <div class="deck-list" id="deck-list"></div>
        </div>
        <div class="card-picker-footer">
            <button class="picker-start-btn" id="picker-start-btn" onclick="confirmTestHand()" disabled>Commencer la partie</button>
        </div>
    </div>

    <div class="game-container" id="game-container">
        <div class="top-bar">
            <div class="header-center">
                <button class="end-turn-btn" id="end-turn-btn" onclick="endTurn()">
                    <div class="end-turn-inner">
                        <span class="end-turn-text">FIN DE TOUR</span>
                        <span class="end-turn-timer"></span>
                        <span class="end-turn-phase"></span>
                        <svg class="end-turn-hourglass" viewBox="0 0 24 24">
                            <path d="M6 2v6l4 4-4 4v6h12v-6l-4-4 4-4V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
        
        <!-- Phase indicator au dessus du terrain adverse -->
        <div class="phase-indicator deploy" id="phase-indicator">Phase de repositionnement</div>
        
        <div class="game-board-wrapper">
            <div class="game-board">
                <div class="side-panel left">
                    <div class="hero-card" id="hero-me" data-owner="me">
                        <div class="hero-card-inner" id="me-hero-inner">
                            <div class="hero-title" id="me-hero-title">Hyrule, proph√®te ultime</div>
                        </div>
                        <div class="hero-hp" id="me-hp">
                            <svg class="hero-hp-svg" viewBox="-116 -116 232 232" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <linearGradient id="heroHpGrad_me" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" stop-color="#f472b6"/>
                                        <stop offset="50%" stop-color="#e11d48"/>
                                        <stop offset="100%" stop-color="#be123c"/>
                                    </linearGradient>
                                    <filter id="heroHpShadow_me" x="-20%" y="-20%" width="140%" height="140%">
                                        <feDropShadow dx="0" dy="0" stdDeviation="7.5" flood-color="black" flood-opacity="0.1"/>
                                        <feDropShadow dx="0" dy="1" stdDeviation="0.5" flood-color="black" flood-opacity="0.9"/>
                                    </filter>
                                </defs>
                                <circle cx="0" cy="0" r="116" fill="#dddddd75"/>
                                <circle cx="0" cy="0" r="100" fill="url(#heroHpGrad_me)"/>
                                <text class="hero-hp-number" x="0" y="0" text-anchor="middle" dominant-baseline="central" font-family="'Glacial Indifference', sans-serif" font-size="140" font-weight="bold" fill="#efefef" filter="url(#heroHpShadow_me)">20</text>
                            </svg>
                        </div>
                    </div>
                    <div class="mana-counter" id="me-energy">1<span class="slash">/</span>1</div>
                    <div class="deck-grave-row">
                        <div class="deck-box" id="me-deck-box">
                            <div class="deck-stack" id="me-deck-stack">
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-top"></div>
                            </div>
                            <div class="deck-tooltip" id="me-deck-tooltip">0 cartes</div>
                        </div>
                        <div class="grave-box clickable" id="me-grave-box" onclick="openGraveyard('me')">
                            <div class="grave-stack" id="me-grave-stack">
                                <div class="grave-card-layer"></div>
                                <div class="grave-card-layer"></div>
                                <div class="grave-card-layer"></div>
                                <div class="grave-top-card empty" id="me-grave-top"><svg class="slot-frame" viewBox="-4 -4 152 200" aria-hidden="true"><path d="M4,0 L68,0 L72,-3 L76,0 L140,0 A4,4 0 0,1 144,4 L144,92 L147,96 L144,100 L144,188 A4,4 0 0,1 140,192 L76,192 L72,195 L68,192 L4,192 A4,4 0 0,1 0,188 L0,100 L-3,96 L0,92 L0,4 A4,4 0 0,1 4,0 Z" class="slot-frame-outline"/><path d="M4,0 L68,0 L72,-3 L76,0 L140,0 A4,4 0 0,1 144,4 L144,92 L147,96 L144,100 L144,188 A4,4 0 0,1 140,192 L76,192 L72,195 L68,192 L4,192 A4,4 0 0,1 0,188 L0,100 L-3,96 L0,92 L0,4 A4,4 0 0,1 4,0 Z" class="slot-frame-fill"/></svg><div class="slot-center"><img src="/battlefield_elements/graveyard.png" class="slot-icon" alt="" draggable="false"></div></div>
                            </div>
                            <div class="grave-tooltip" id="me-grave-tooltip">0 carte</div>
                        </div>
                    </div>
                </div>
                
                <div class="battlefield" id="battlefield">
                    <div class="global-spell-zone" id="global-spell-zone"></div>
                </div>
                
                <div class="side-panel right">
                    <div class="hero-card" id="hero-opp" data-owner="opp">
                        <div class="hero-card-inner" id="opp-hero-inner">
                            <div class="hero-title" id="opp-hero-title">Zdejebel, fille de satan</div>
                        </div>
                        <div class="hero-hp" id="opp-hp">
                            <svg class="hero-hp-svg" viewBox="-116 -116 232 232" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <linearGradient id="heroHpGrad_opp" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" stop-color="#f472b6"/>
                                        <stop offset="50%" stop-color="#e11d48"/>
                                        <stop offset="100%" stop-color="#be123c"/>
                                    </linearGradient>
                                    <filter id="heroHpShadow_opp" x="-20%" y="-20%" width="140%" height="140%">
                                        <feDropShadow dx="0" dy="0" stdDeviation="7.5" flood-color="black" flood-opacity="0.1"/>
                                        <feDropShadow dx="0" dy="1" stdDeviation="0.5" flood-color="black" flood-opacity="0.9"/>
                                    </filter>
                                </defs>
                                <circle cx="0" cy="0" r="116" fill="#dddddd75"/>
                                <circle cx="0" cy="0" r="100" fill="url(#heroHpGrad_opp)"/>
                                <text class="hero-hp-number" x="0" y="0" text-anchor="middle" dominant-baseline="central" font-family="'Glacial Indifference', sans-serif" font-size="140" font-weight="bold" fill="#efefef" filter="url(#heroHpShadow_opp)">20</text>
                            </svg>
                        </div>
                    </div>
                    <div class="mana-counter" id="opp-energy">1<span class="slash">/</span>1</div>
                    <div class="deck-grave-row">
                        <div class="grave-box clickable" id="opp-grave-box" onclick="openGraveyard('opp')">
                            <div class="grave-stack" id="opp-grave-stack">
                                <div class="grave-card-layer"></div>
                                <div class="grave-card-layer"></div>
                                <div class="grave-card-layer"></div>
                                <div class="grave-top-card empty" id="opp-grave-top"><svg class="slot-frame" viewBox="-4 -4 152 200" aria-hidden="true"><path d="M4,0 L68,0 L72,-3 L76,0 L140,0 A4,4 0 0,1 144,4 L144,92 L147,96 L144,100 L144,188 A4,4 0 0,1 140,192 L76,192 L72,195 L68,192 L4,192 A4,4 0 0,1 0,188 L0,100 L-3,96 L0,92 L0,4 A4,4 0 0,1 4,0 Z" class="slot-frame-outline"/><path d="M4,0 L68,0 L72,-3 L76,0 L140,0 A4,4 0 0,1 144,4 L144,92 L147,96 L144,100 L144,188 A4,4 0 0,1 140,192 L76,192 L72,195 L68,192 L4,192 A4,4 0 0,1 0,188 L0,100 L-3,96 L0,92 L0,4 A4,4 0 0,1 4,0 Z" class="slot-frame-fill"/></svg><div class="slot-center"><img src="/battlefield_elements/graveyard.png" class="slot-icon" alt="" draggable="false"></div></div>
                            </div>
                            <div class="grave-tooltip" id="opp-grave-tooltip">0 carte</div>
                        </div>
                        <div class="deck-box" id="opp-deck-box">
                            <div class="deck-stack" id="opp-deck-stack">
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-top"></div>
                            </div>
                            <div class="deck-tooltip" id="opp-deck-tooltip">0 cartes</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="my-hand" id="my-hand"></div>
        <div class="opp-hand" id="opp-hand"></div>

    </div>
    
    <!-- Backdrop sombre pour R√©animation -->
    <div class="reanimate-backdrop" id="reanimate-backdrop"></div>
    <!-- Popup Cimeti√®re -->
    <div class="graveyard-popup" id="graveyard-popup">
        <div class="graveyard-border">
            <div class="graveyard-inner">
                <div class="graveyard-header">
                    <span class="graveyard-title" id="graveyard-popup-title">Cimeti√®re</span>
                    <button class="panel-close" onclick="closeGraveyard()">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/>
                        </svg>
                    </button>
                </div>
                <div class="graveyard-cards" id="graveyard-cards">
                    <div class="graveyard-empty">Aucune carte au cimeti√®re</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Round Banner Overlay -->
    <div class="round-banner-overlay" id="round-banner-overlay">
        <div class="round-banner-rays"></div>
        <div class="round-banner-glow"></div>
        <div class="round-banner-ribbon">
            <svg viewBox="0 0 520 120" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <!-- Dark fill matching player frame -->
                    <linearGradient id="ribbon-grad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="#1e1e1e"/>
                        <stop offset="15%" stop-color="#151515"/>
                        <stop offset="50%" stop-color="#0a0a0a"/>
                        <stop offset="85%" stop-color="#151515"/>
                        <stop offset="100%" stop-color="#1e1e1e"/>
                    </linearGradient>
                    <!-- Bronze border matching player frame -->
                    <linearGradient id="ribbon-border-grad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#8b7355"/>
                        <stop offset="15%" stop-color="#d4c4a8"/>
                        <stop offset="30%" stop-color="#a08060"/>
                        <stop offset="50%" stop-color="#6b5344"/>
                        <stop offset="70%" stop-color="#8b7355"/>
                        <stop offset="85%" stop-color="#c4b896"/>
                        <stop offset="100%" stop-color="#8b7355"/>
                    </linearGradient>
                    <linearGradient id="ribbon-shine" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="rgba(255,255,255,0.06)"/>
                        <stop offset="30%" stop-color="rgba(255,255,255,0)"/>
                    </linearGradient>
                    <linearGradient id="ribbon-inner-border" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="rgba(196,184,150,0.25)"/>
                        <stop offset="50%" stop-color="rgba(196,184,150,0.08)"/>
                        <stop offset="100%" stop-color="rgba(196,184,150,0.25)"/>
                    </linearGradient>
                    <!-- Subtle inner glow -->
                    <radialGradient id="ribbon-inner-glow" cx="50%" cy="50%">
                        <stop offset="0%" stop-color="rgba(139,115,85,0.12)"/>
                        <stop offset="100%" stop-color="transparent"/>
                    </radialGradient>
                    <!-- Ornate pattern for ribbon -->
                    <pattern id="ribbon-pattern" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
                        <path d="M20 0 L22 8 L20 6 L18 8 Z" fill="rgba(180,160,120,0.04)"/>
                        <path d="M0 20 L8 22 L6 20 L8 18 Z" fill="rgba(180,160,120,0.03)"/>
                        <circle cx="20" cy="20" r="1" fill="rgba(180,160,120,0.05)"/>
                    </pattern>
                </defs>
                <!-- Main ribbon shape -->
                <path d="M30,8 L490,8 L510,60 L490,112 L30,112 L10,60 Z" fill="url(#ribbon-grad)" stroke="url(#ribbon-border-grad)" stroke-width="3.5" stroke-linejoin="round"/>
                <!-- Ornate pattern overlay -->
                <path d="M30,8 L490,8 L510,60 L490,112 L30,112 L10,60 Z" fill="url(#ribbon-pattern)"/>
                <!-- Inner glow -->
                <path d="M30,8 L490,8 L510,60 L490,112 L30,112 L10,60 Z" fill="url(#ribbon-inner-glow)"/>
                <!-- Top light reflection -->
                <path d="M30,8 L490,8 L510,60 L490,112 L30,112 L10,60 Z" fill="url(#ribbon-shine)"/>
                <!-- Inner border -->
                <path d="M42,18 L478,18 L496,60 L478,102 L42,102 L24,60 Z" fill="none" stroke="url(#ribbon-inner-border)" stroke-width="0.8"/>
                <!-- Decorative lines -->
                <line x1="65" y1="26" x2="190" y2="26" stroke="rgba(180,160,120,0.10)" stroke-width="0.5"/>
                <line x1="330" y1="26" x2="455" y2="26" stroke="rgba(180,160,120,0.10)" stroke-width="0.5"/>
                <line x1="65" y1="94" x2="190" y2="94" stroke="rgba(180,160,120,0.10)" stroke-width="0.5"/>
                <line x1="330" y1="94" x2="455" y2="94" stroke="rgba(180,160,120,0.10)" stroke-width="0.5"/>
                <!-- Corner ornaments -->
                <path d="M55 22 Q60 18 65 22" fill="none" stroke="rgba(196,184,150,0.15)" stroke-width="0.6"/>
                <path d="M455 22 Q460 18 465 22" fill="none" stroke="rgba(196,184,150,0.15)" stroke-width="0.6"/>
                <path d="M55 98 Q60 102 65 98" fill="none" stroke="rgba(196,184,150,0.15)" stroke-width="0.6"/>
                <path d="M455 98 Q460 102 465 98" fill="none" stroke="rgba(196,184,150,0.15)" stroke-width="0.6"/>
            </svg>
            <div class="round-banner-content">
                <div class="round-banner-label">ROUND</div>
                <div class="round-banner-number" id="round-banner-number">1</div>
            </div>
        </div>
    </div>

    <div class="game-over hidden" id="game-over">
        <div class="game-over-box">
            <div class="game-over-title">üèÜ Fin de Partie</div>
            <div class="game-over-result" id="result">Victoire !</div>
            <button class="lobby-btn btn-create" onclick="location.reload()">üîÑ Rejouer</button>
        </div>
    </div>

    </div><!-- /game-scaler -->

    <!-- √âl√©ments viewport (hors game-scaler, position fixed au bord de l'√©cran) -->
    <div class="player-info-bar left viewport-player">
        <div class="player-frame" id="me-player-frame">
            <svg class="frame-svg" id="me-frame-svg" viewBox="0 0 300 100" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>
            <div class="player-name-zone">
                <h2 class="player-name-text" id="me-pseudo">DarkSlayer42</h2>
                <div class="player-title" id="me-title">Grand Champion</div>
            </div>
            <div class="rank-gem-slot" id="me-rank-badge"></div>
            <div class="shimmer-line"></div>
        </div>
    </div>
    <div class="player-info-bar right viewport-player">
        <div class="player-frame" id="opp-player-frame">
            <svg class="frame-svg" id="opp-frame-svg" viewBox="0 0 300 100" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>
            <div class="player-name-zone">
                <h2 class="player-name-text" id="opp-pseudo">ShadowMage99</h2>
                <div class="player-title" id="opp-title">Grand Champion</div>
            </div>
            <div class="rank-gem-slot" id="opp-rank-badge"></div>
            <div class="shimmer-line"></div>
        </div>
    </div>

    <div class="panel-overlay" id="panel-overlay"></div>

    <div class="buttons-right">
        <div class="half-button bronze" id="btnJournal" title="Journal de bataille">
            <div class="half-button-inner">
                <svg class="icon icon-book" viewBox="0 0 24 24">
                    <path d="M6 2C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H18C19.11 22 20 21.11 20 20V4C20 2.9 19.11 2 18 2H6ZM6 4H11V12L8.5 10.5L6 12V4Z"/>
                </svg>
            </div>
        </div>
        <div class="half-button bronze" id="btnSettings" title="Param√®tres">
            <div class="half-button-inner">
                <svg class="icon icon-settings" viewBox="0 0 24 24">
                    <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5A3.5 3.5 0 0 1 15.5 12A3.5 3.5 0 0 1 12 15.5M19.43 12.97C19.47 12.65 19.5 12.33 19.5 12C19.5 11.67 19.47 11.34 19.43 11L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.96 19.05 5.05L16.56 6.05C16.04 5.66 15.5 5.32 14.87 5.07L14.5 2.42C14.46 2.18 14.25 2 14 2H10C9.75 2 9.54 2.18 9.5 2.42L9.13 5.07C8.5 5.32 7.96 5.66 7.44 6.05L4.95 5.05C4.73 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.21 8.95 2.27 9.22 2.46 9.37L4.57 11C4.53 11.34 4.5 11.67 4.5 12C4.5 12.33 4.53 12.65 4.57 12.97L2.46 14.63C2.27 14.78 2.21 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.73 19.03 4.95 18.95L7.44 17.94C7.96 18.34 8.5 18.68 9.13 18.93L9.5 21.58C9.54 21.82 9.75 22 10 22H14C14.25 22 14.46 21.82 14.5 21.58L14.87 18.93C15.5 18.67 16.04 18.34 16.56 17.94L19.05 18.95C19.27 19.03 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.97Z"/>
                </svg>
            </div>
        </div>
    </div>

    <div class="panel" id="panelJournal">
        <div class="panel-border">
            <div class="panel-inner">
                <div class="panel-header">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M6 2C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H18C19.11 22 20 21.11 20 20V4C20 2.9 19.11 2 18 2H6ZM6 4H11V12L8.5 10.5L6 12V4Z"/>
                    </svg>
                    <span class="panel-title">Journal de Bataille</span>
                    <button class="panel-close" id="closeJournal">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/>
                        </svg>
                    </button>
                </div>
                <div class="panel-content" id="log-content"></div>
            </div>
        </div>
    </div>

    <div class="panel" id="panelSettings">
        <div class="panel-border">
            <div class="panel-inner">
                <div class="panel-header">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5A3.5 3.5 0 0 1 15.5 12A3.5 3.5 0 0 1 12 15.5M19.43 12.97C19.47 12.65 19.5 12.33 19.5 12C19.5 11.67 19.47 11.34 19.43 11L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.96 19.05 5.05L16.56 6.05C16.04 5.66 15.5 5.32 14.87 5.07L14.5 2.42C14.46 2.18 14.25 2 14 2H10C9.75 2 9.54 2.18 9.5 2.42L9.13 5.07C8.5 5.32 7.96 5.66 7.44 6.05L4.95 5.05C4.73 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.21 8.95 2.27 9.22 2.46 9.37L4.57 11C4.53 11.34 4.5 11.67 4.5 12C4.5 12.33 4.53 12.65 4.57 12.97L2.46 14.63C2.27 14.78 2.21 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.73 19.03 4.95 18.95L7.44 17.94C7.96 18.34 8.5 18.68 9.13 18.93L9.5 21.58C9.54 21.82 9.75 22 10 22H14C14.25 22 14.46 21.82 14.5 21.58L14.87 18.93C15.5 18.67 16.04 18.34 16.56 17.94L19.05 18.95C19.27 19.03 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.97Z"/>
                    </svg>
                    <span class="panel-title">Param√®tres</span>
                    <button class="panel-close" id="closeSettings">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/>
                        </svg>
                    </button>
                </div>
                <div class="panel-content">
                    <div class="setting-group">
                        <div class="setting-label">Audio</div>
                        <div class="setting-row">
                            <span class="setting-name">Musique</span>
                            <div class="slider-container">
                                <input type="range" class="setting-slider" min="0" max="100" value="50" id="musicVolume" onchange="setMusicVolume(this.value)">
                                <span class="slider-value" id="musicValue">50%</span>
                            </div>
                        </div>
                        <div class="setting-row">
                            <span class="setting-name">Effets sonores</span>
                            <div class="slider-container">
                                <input type="range" class="setting-slider" min="0" max="100" value="50" id="sfxVolume" onchange="setSfxVolume(this.value)">
                                <span class="slider-value" id="sfxValue">50%</span>
                            </div>
                        </div>
                    </div>
                    <div class="setting-group">
                        <div class="setting-label">Actions</div>
                        <div class="surrender-pill" onclick="surrender()">
                            <div class="surrender-pill-inner">
                                <span class="surrender-text">Capituler</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <canvas id="gl-canvas"></canvas>

    <script src="/js/animations.js"></script>
    <script src="/js/combat-vfx.js"></script>
    <script src="/js/combat-animation.js"></script>
    <script src="/js/card-glow.js"></script>
    <script src="/js/card-renderer.js"></script>
    <script src="/js/pixi-card-view.js"></script>
    <script src="/js/pixi-hand-layer.js"></script>
    <script src="/js/pixi-board-layer.js"></script>
    <script src="/js/arrow-targeting.js"></script>
    <script src="/js/custom-drag.js"></script>
    <!-- Game modules (ordre de chargement important) -->
    <script src="/js/game-globals.js"></script>
    <script src="/js/game-animations.js"></script>
    <script src="/js/game-ui.js"></script>
    <script src="/js/game-board.js"></script>
    <script src="/js/game-render.js"></script>
    <script src="/js/game-core.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öîÔ∏è Bataille des H√©ros</title>
    <script src="/socket.io/socket.io.js"></script>
    <!-- PixiJS pour les animations de combat -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/8.2.6/pixi.min.js"></script>
    <!-- Polices pour les cartes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bree+Serif&family=Cinzel:wght@700;900&family=Merriweather+Sans:wght@400;700;800&family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="lobby" id="lobby">
        <h1 class="lobby-title">‚öîÔ∏è Bataille des H√©ros</h1>
        <div class="lobby-box" id="lobby-menu">
            <h2 style="margin-bottom:25px;color:#ffd700;">Multijoueur</h2>
            <button class="lobby-btn btn-create" onclick="createRoom()">üéÆ Cr√©er une partie</button>
            <div style="margin:18px 0;color:#666;">‚Äî ou ‚Äî</div>
            <input type="text" class="room-code-input" id="room-code-input" placeholder="CODE" maxlength="6">
            <button class="lobby-btn btn-join" onclick="joinRoom()">üö™ Rejoindre</button>
        </div>
        <div class="lobby-box hidden" id="lobby-waiting">
            <h2 style="color:#ffd700;margin-bottom:15px;">Partie cr√©√©e !</h2>
            <p style="color:#aaa;margin-bottom:8px;">Partagez ce code :</p>
            <div class="room-code-display" id="room-code-display">------</div>
            <p class="waiting-text">‚è≥ En attente d'un adversaire...</p>
        </div>
    </div>
    
    <!-- Card Zoom Overlay -->
    <div class="card-zoom-overlay hidden" id="card-zoom-overlay">
        <div class="card-zoom-container" id="card-zoom-container"></div>
    </div>

    <!-- Mulligan Overlay -->
    <div class="mulligan-overlay hidden" id="mulligan-overlay">
        <div class="mulligan-timer" id="mulligan-timer">15</div>
        <div class="mulligan-title">üé¥ Votre Main de D√©part</div>
        <div class="mulligan-subtitle">Gardez cette main ou piochez 7 nouvelles cartes</div>
        <div class="mulligan-hand" id="mulligan-hand"></div>
        <div class="mulligan-buttons" id="mulligan-buttons">
            <button class="mulligan-btn keep" onclick="keepHand()">‚úÖ Garder</button>
            <button class="mulligan-btn reroll" onclick="doMulligan()">üîÑ Mulligan</button>
        </div>
        <div class="mulligan-waiting hidden" id="mulligan-waiting">‚è≥ En attente de l'adversaire...</div>
    </div>

    <div class="game-container" id="game-container">
        <div class="top-bar">
            <div class="player-info-bar left">
                <div class="player-name-badge">
                    <img src="/css/rangbronze.png" class="rank-icon" id="me-rank-icon" alt="Rang">
                    <span class="player-name-text" id="me-pseudo">DarkSlayer42</span>
                </div>
            </div>
            <div class="header-center">
                <button class="end-turn-btn" id="end-turn-btn" onclick="endTurn()">
                    <div class="end-turn-inner">
                        <span class="end-turn-text">FIN DE TOUR</span>
                        <span class="end-turn-timer"></span>
                        <span class="end-turn-phase"></span>
                        <svg class="end-turn-hourglass" viewBox="0 0 24 24">
                            <path d="M6 2v6l4 4-4 4v6h12v-6l-4-4 4-4V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z"/>
                        </svg>
                    </div>
                </button>
            </div>
            <div class="player-info-bar right">
                <div class="player-name-badge">
                    <span class="player-name-text" id="opp-pseudo">ShadowMage99</span>
                    <img src="/css/rangbronze.png" class="rank-icon" id="opp-rank-icon" alt="Rang">
                </div>
            </div>
        </div>
        
        <!-- Phase indicator au dessus du terrain adverse -->
        <div class="phase-indicator deploy" id="phase-indicator">Phase de repositionnement</div>
        
        <div class="game-board-wrapper">
            <div class="game-board">
                <div class="side-panel left">
                    <div class="hero-card" id="hero-me">
                        <div class="hero-card-inner" id="me-hero-inner">
                            <div class="hero-title" id="me-hero-title">Hyrule, proph√®te ultime</div>
                        </div>
                        <div class="hero-hp" id="me-hp">
                            <div class="hero-hp-inner">
                                <span class="hero-hp-number">20</span>
                            </div>
                        </div>
                        <div class="hero-mana" id="me-energy">
                            <div class="hero-mana-inner">
                                <span class="hero-mana-number">1/1</span>
                            </div>
                        </div>
                    </div>
                    <div class="deck-grave-row">
                        <div class="deck-box" id="me-deck-box">
                            <div class="deck-stack" id="me-deck-stack">
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-top"></div>
                            </div>
                            <div class="deck-tooltip" id="me-deck-tooltip">0 cartes</div>
                        </div>
                        <div class="grave-box clickable" id="me-grave-box" onclick="openGraveyard('me')">
                            <div class="grave-stack" id="me-grave-stack">
                                <div class="grave-card-layer"></div>
                                <div class="grave-card-layer"></div>
                                <div class="grave-card-layer"></div>
                                <div class="grave-top-card empty" id="me-grave-top"></div>
                            </div>
                            <div class="grave-tooltip" id="me-grave-tooltip">0 carte</div>
                        </div>
                    </div>
                </div>
                
                <div class="battlefield" id="battlefield">
                    <div class="global-spell-zone" id="global-spell-zone"></div>
                </div>
                
                <div class="side-panel right">
                    <div class="hero-card" id="hero-opp">
                        <div class="hero-card-inner" id="opp-hero-inner">
                            <div class="hero-title" id="opp-hero-title">Zdejebel, fille de satan</div>
                        </div>
                        <div class="hero-hp" id="opp-hp">
                            <div class="hero-hp-inner">
                                <span class="hero-hp-number">20</span>
                            </div>
                        </div>
                        <div class="hero-mana" id="opp-energy">
                            <div class="hero-mana-inner">
                                <span class="hero-mana-number">1/1</span>
                            </div>
                        </div>
                    </div>
                    <div class="deck-grave-row">
                        <div class="grave-box clickable" id="opp-grave-box" onclick="openGraveyard('opp')">
                            <div class="grave-stack" id="opp-grave-stack">
                                <div class="grave-card-layer"></div>
                                <div class="grave-card-layer"></div>
                                <div class="grave-card-layer"></div>
                                <div class="grave-top-card empty" id="opp-grave-top"></div>
                            </div>
                            <div class="grave-tooltip" id="opp-grave-tooltip">0 carte</div>
                        </div>
                        <div class="deck-box" id="opp-deck-box">
                            <div class="deck-stack" id="opp-deck-stack">
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-layer"></div>
                                <div class="deck-card-top"></div>
                            </div>
                            <div class="deck-tooltip" id="opp-deck-tooltip">0 cartes</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="my-hand" id="my-hand"></div>
        <div class="opp-hand" id="opp-hand"></div>

        <!-- Overlay pour fermer les panneaux -->
        <div class="panel-overlay" id="panel-overlay"></div>

        <!-- Boutons sur le c√¥t√© droit -->
        <div class="buttons-right">
            <div class="half-button bronze" id="btnJournal" title="Journal de bataille">
                <div class="half-button-inner">
                    <svg class="icon icon-book" viewBox="0 0 24 24">
                        <path d="M6 2C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H18C19.11 22 20 21.11 20 20V4C20 2.9 19.11 2 18 2H6ZM6 4H11V12L8.5 10.5L6 12V4Z"/>
                    </svg>
                </div>
            </div>
            <div class="half-button bronze" id="btnSettings" title="Param√®tres">
                <div class="half-button-inner">
                    <svg class="icon icon-settings" viewBox="0 0 24 24">
                        <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5A3.5 3.5 0 0 1 15.5 12A3.5 3.5 0 0 1 12 15.5M19.43 12.97C19.47 12.65 19.5 12.33 19.5 12C19.5 11.67 19.47 11.34 19.43 11L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.96 19.05 5.05L16.56 6.05C16.04 5.66 15.5 5.32 14.87 5.07L14.5 2.42C14.46 2.18 14.25 2 14 2H10C9.75 2 9.54 2.18 9.5 2.42L9.13 5.07C8.5 5.32 7.96 5.66 7.44 6.05L4.95 5.05C4.73 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.21 8.95 2.27 9.22 2.46 9.37L4.57 11C4.53 11.34 4.5 11.67 4.5 12C4.5 12.33 4.53 12.65 4.57 12.97L2.46 14.63C2.27 14.78 2.21 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.73 19.03 4.95 18.95L7.44 17.94C7.96 18.34 8.5 18.68 9.13 18.93L9.5 21.58C9.54 21.82 9.75 22 10 22H14C14.25 22 14.46 21.82 14.5 21.58L14.87 18.93C15.5 18.67 16.04 18.34 16.56 17.94L19.05 18.95C19.27 19.03 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.97Z"/>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Panneau Journal de Bataille -->
        <div class="panel" id="panelJournal">
            <div class="panel-border">
                <div class="panel-inner">
                    <div class="panel-header">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M6 2C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H18C19.11 22 20 21.11 20 20V4C20 2.9 19.11 2 18 2H6ZM6 4H11V12L8.5 10.5L6 12V4Z"/>
                        </svg>
                        <span class="panel-title">Journal de Bataille</span>
                        <button class="panel-close" id="closeJournal">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="panel-content" id="log-content"></div>
                </div>
            </div>
        </div>

        <!-- Panneau Settings -->
        <div class="panel" id="panelSettings">
            <div class="panel-border">
                <div class="panel-inner">
                    <div class="panel-header">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5A3.5 3.5 0 0 1 15.5 12A3.5 3.5 0 0 1 12 15.5M19.43 12.97C19.47 12.65 19.5 12.33 19.5 12C19.5 11.67 19.47 11.34 19.43 11L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.96 19.05 5.05L16.56 6.05C16.04 5.66 15.5 5.32 14.87 5.07L14.5 2.42C14.46 2.18 14.25 2 14 2H10C9.75 2 9.54 2.18 9.5 2.42L9.13 5.07C8.5 5.32 7.96 5.66 7.44 6.05L4.95 5.05C4.73 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.21 8.95 2.27 9.22 2.46 9.37L4.57 11C4.53 11.34 4.5 11.67 4.5 12C4.5 12.33 4.53 12.65 4.57 12.97L2.46 14.63C2.27 14.78 2.21 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.73 19.03 4.95 18.95L7.44 17.94C7.96 18.34 8.5 18.68 9.13 18.93L9.5 21.58C9.54 21.82 9.75 22 10 22H14C14.25 22 14.46 21.82 14.5 21.58L14.87 18.93C15.5 18.67 16.04 18.34 16.56 17.94L19.05 18.95C19.27 19.03 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.97Z"/>
                        </svg>
                        <span class="panel-title">Param√®tres</span>
                        <button class="panel-close" id="closeSettings">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="panel-content">
                        <div class="setting-group">
                            <div class="setting-label">Audio</div>
                            <div class="setting-row">
                                <span class="setting-name">Musique</span>
                                <div class="slider-container">
                                    <input type="range" class="setting-slider" min="0" max="100" value="50" id="musicVolume" onchange="setMusicVolume(this.value)">
                                    <span class="slider-value" id="musicValue">50%</span>
                                </div>
                            </div>
                            <div class="setting-row">
                                <span class="setting-name">Effets sonores</span>
                                <div class="slider-container">
                                    <input type="range" class="setting-slider" min="0" max="100" value="50" id="sfxVolume" onchange="setSfxVolume(this.value)">
                                    <span class="slider-value" id="sfxValue">50%</span>
                                </div>
                            </div>
                        </div>
                        <div class="setting-group">
                            <div class="setting-label">Actions</div>
                            <div class="surrender-pill" onclick="surrender()">
                                <div class="surrender-pill-inner">
                                    <span class="surrender-text">Capituler</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Popup Cimeti√®re -->
    <div class="graveyard-popup" id="graveyard-popup">
        <div class="graveyard-border">
            <div class="graveyard-inner">
                <div class="graveyard-header">
                    <span class="graveyard-title" id="graveyard-popup-title">Cimeti√®re</span>
                    <button class="panel-close" onclick="closeGraveyard()">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/>
                        </svg>
                    </button>
                </div>
                <div class="graveyard-cards" id="graveyard-cards">
                    <div class="graveyard-empty">Aucune carte au cimeti√®re</div>
                </div>
            </div>
        </div>
    </div>

    <div class="game-over hidden" id="game-over">
        <div class="game-over-box">
            <div class="game-over-title">üèÜ Fin de Partie</div>
            <div class="game-over-result" id="result">Victoire !</div>
            <button class="lobby-btn btn-create" onclick="location.reload()">üîÑ Rejouer</button>
        </div>
    </div>

    <script src="/js/animations.js"></script>
    <script src="/js/combat-vfx.js"></script>
    <script src="/js/combat-animation.js"></script>
    <script src="/js/card-renderer.js"></script>
    <script src="/js/animations/effects.js"></script>
    <script src="/js/custom-drag.js"></script>
    <script src="/js/game.js"></script>
</body>
</html>